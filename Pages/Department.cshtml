@page
@model MyCoreApp.Pages.DepartmentModel
@{
    ViewData["Title"] = "Department";
}
@using MyCoreApp.Models
@using MyCoreApp.Data
@using Microsoft.AspNetCore.Mvc

@inject ProfessorDetailService ProfessorService
@inject OfficeHoursDetailService OfficeHoursService

<body id="corley">
    <h1>@ViewData["Title"]</h1>
        <div id="searchBar">
            <form action="phpSearch.php" method="post">
                <label for="search">Select Department:</label>
                <select name="Department">
                    <option value="option1">Computer Science</option>
                    <option value="option2">Mathematics</option>
                    <option value="option3">Mechanical Engineering</option>
                    <option value="option3">Electrical Engineering</option>
                    <!-- Add more options as needed -->
                </select>
                <br>
                <input type="submit">
            </form>
        </div>
    <section id="upcoming-hours">
            <ul>
                @if (Model != null)
                {
                    var allProfessors = ProfessorService.GetProfessorInfo("SELECT * from professor ORDER BY Department, LName, FName").Result;
                    var allOfficeHours = OfficeHoursService.GetOfficeHoursInfo("SELECT * from officehours").Result;

                    @foreach (var professor in allProfessors)
                    {
                        var officeHoursForProfessor = allOfficeHours.Where(oh => oh.ProfessorID == professor.ProfessorID);

                        <li>
                            <table>
                                <tr>
                                    <td id="column1"><strong>Instructor:</strong></td>
                                    <td id="column2">@professor.FullName</td>
                                </tr>
                                <tr>
                                    <td id="column1"><strong>Office Hours:</strong></td>
                                    <td id="column2">
                                        @if (officeHoursForProfessor.Any())
                                        {
                                            @foreach (var officeHours in officeHoursForProfessor)
                                            {
                                                <div>
                                                    <span>@officeHours.DayOfWeek: </span>
                                                    <span>@officeHours.StartTime - @officeHours.EndTime</span>
                                                </div>
                                            }
                                        }
                                        else
                                        {
                                            <div>No office hours available</div>
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <td id="column1"><strong>Department:</strong></td>
                                    <td id="column2">@professor.Department</td>
                                </tr>
                                <tr>
                                    <td id="column1"><strong>Room Number:</strong></td>
                                    <td id="column2">@professor.OfficeNum</td>
                                </tr>
                                <tr>
                                    <td id="column1"><strong>Contact Info:</strong></td>
                                    <td id="column2">@professor.Email @professor.Phone</td>
                                </tr>
                            </table>
                        </li>
                    }
                }
                else
                {
                    <li>
                        <table>
                            <tr>
                                <td colspan="7">No professors found.</td>
                            </tr>
                        </table>
                    </li>
                }
            </ul>
    </section>
</body>
}